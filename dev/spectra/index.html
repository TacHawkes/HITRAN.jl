<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Calculating spectra · HITRAN.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HITRAN.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction &amp; Motivation</a></li><li><a class="tocitem" href="../quickstart/">Quickstart/Example</a></li><li><a class="tocitem" href="../database/">Local HITRAN database</a></li><li class="is-active"><a class="tocitem" href>Calculating spectra</a><ul class="internal"><li><a class="tocitem" href="#The-absorption-coefficient"><span>The absorption coefficient</span></a></li><li><a class="tocitem" href="#Environments"><span>Environments</span></a></li><li><a class="tocitem" href="#Instrument-functions"><span>Instrument functions</span></a></li><li><a class="tocitem" href="#Convenience-functions"><span>Convenience functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Calculating spectra</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Calculating spectra</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tachawkes/hitran.jl/blob/master/docs/src/spectra.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions-for-absorption-spectrum-calculation"><a class="docs-heading-anchor" href="#Functions-for-absorption-spectrum-calculation">Functions for absorption spectrum calculation</a><a id="Functions-for-absorption-spectrum-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-for-absorption-spectrum-calculation" title="Permalink"></a></h1><p>The most important function of the module is the <a href="#HITRAN.α"><code>α</code></a> function. Before using i, you have to initialise a database and use the <a href="../database/#HITRAN.fetch!"><code>fetch!</code></a> function to retrieve line-by-line data.</p><h2 id="The-absorption-coefficient"><a class="docs-heading-anchor" href="#The-absorption-coefficient">The absorption coefficient</a><a id="The-absorption-coefficient-1"></a><a class="docs-heading-anchor-permalink" href="#The-absorption-coefficient" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="HITRAN.α" href="#HITRAN.α"><code>HITRAN.α</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">α(tables::AbstractVector{String} [, profile=:hartmann_tran; kwargs...])</code></pre><p>Computes the absorption coefficient using line-by-line data stored in the database tables specified in <code>tables</code>. The lineshape can be optionally specified using the <code>profile</code> argument and one of the Symbol keys <code>:hartmann_tran</code>, <code>:voigt</code>, <code>:sdvoigt</code>, <code>:lorentz</code>, <code>:gauss</code>. If no keyword arguments are specified, they will be automatically chosen from the tables provided.</p><p><strong>Keyword arguments</strong></p><ul><li><code>components</code>: the components of the gas mixture for the calculation. Can be either a vector of tuples with <code>(molecule_id, local_iso_id)</code>               or a <code>Dict</code> with the <code>(molecule_id, local_iso_id)</code> tuple as key and the abundance as value. If the vector of tuples is supplied               the natural abundance will be used, so this makes no sense for gas mixtures other than isotopologues of the same molecule.</li><li><code>intensity_threshold</code>: the minimum line strength in <span>$cm^{-1}/(\text{molecule} \cdot cm^{-2})$</span></li><li><code>pressure</code>: the environmental pressure in atmospheres (default: 1.0 atm)</li><li><code>temperature</code>: the environmental temperature in Kelvin (default: 296.0 K)</li><li><code>ν</code>: a vector or range of wavenumbers for which the absorption should be calculated. Useful for reusing the output ν vector for multiple calculations. If ν is supplied ν_range will be ignored.[]</li><li><code>ν_range</code>: a tuple of the form (ν<em>min, ν</em>max) where ν<em>min/ν</em>max is the minimum/maximum wavenumber for the absorption_spectrum respectively in <span>$cm^{-1}$</span></li><li><code>ν_step</code>: the wavenumber step in <span>$cm^{-1}$</span> (default: 0.01 <span>$cm^{-1}$</span>)</li><li><code>ν_wing</code>: absolute calculation width of a line in <span>$cm^{-1}$</span> (default: 0 <span>$cm^{-1}$</span>)</li><li><code>ν_wing_hw</code>: relative calculation width of a line in multiples of a half-width (default: 50)</li><li><code>diluent</code>: a <code>Dict</code> of the diluting substances, specified as <code>Symbol</code>, e.g. <code>:air</code> or <code>:H2O</code> for the key and the relative concentration as key (default: <code>Dict(:self =&gt; 1.0)</code>). See the example for details.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/profiles.jl#LL186-L208">source</a></section></article><h2 id="Environments"><a class="docs-heading-anchor" href="#Environments">Environments</a><a id="Environments-1"></a><a class="docs-heading-anchor-permalink" href="#Environments" title="Permalink"></a></h2><p>There are two default environments defined at the moment, which ease the calculation of atmospheric spectra.</p><h3 id="Dry-air"><a class="docs-heading-anchor" href="#Dry-air">Dry air</a><a id="Dry-air-1"></a><a class="docs-heading-anchor-permalink" href="#Dry-air" title="Permalink"></a></h3><p>The first environment is dry air which can be accessed using <code>default_environments[:dry_air]</code>. The following composition is used <sup class="footnote-reference"><a id="citeref-Picard2008" href="#footnote-Picard2008">[Picard2008]</a></sup>. Only HITRAN listed gases are used:</p><table><tr><th style="text-align: left">Gas</th><th style="text-align: right">Volume (ppmv)</th></tr><tr><td style="text-align: left"><span>$N_2$</span></td><td style="text-align: right">780,848</td></tr><tr><td style="text-align: left"><span>$O_2$</span></td><td style="text-align: right">209,390</td></tr><tr><td style="text-align: left"><span>$CO_2$</span></td><td style="text-align: right">400</td></tr><tr><td style="text-align: left"><span>$CH_4$</span></td><td style="text-align: right">1.5</td></tr><tr><td style="text-align: left"><span>$H_2$</span></td><td style="text-align: right">0.5</td></tr><tr><td style="text-align: left"><span>$N_2O$</span></td><td style="text-align: right">0.3</td></tr><tr><td style="text-align: left"><span>$CO$</span></td><td style="text-align: right">0.2</td></tr></table><h3 id="Moist-air"><a class="docs-heading-anchor" href="#Moist-air">Moist air</a><a id="Moist-air-1"></a><a class="docs-heading-anchor-permalink" href="#Moist-air" title="Permalink"></a></h3><p>The second environment model is moist air which takes the relative humidity into the account. You can use the function <code>moist_air</code> to get a  composition dictionary with the correct water concentration.</p><article class="docstring"><header><a class="docstring-binding" id="HITRAN.moist_air" href="#HITRAN.moist_air"><code>HITRAN.moist_air</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">moist_air(humidity [, pressure=c_p_ref, temp=c_T_ref])</code></pre><p>Returns a component list for moist air at relative humidity with the corresponding abundances of all components. The pressure (in atm) and the temperature (in K) have to be provided otherwise the HITRAN defaults will be used.</p><div class="admonition is-info"><header class="admonition-header">Valid range</header><div class="admonition-body"><p>Please note that the underlying model for the saturation vapor pressure uses separate models for water and ice. It should provide reasonable values within the range of 200 to 400 K and between 0.6 to 1.1 atm.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/meta/environments.jl#LL39-L50">source</a></section></article><h2 id="Instrument-functions"><a class="docs-heading-anchor" href="#Instrument-functions">Instrument functions</a><a id="Instrument-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Instrument-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="HITRAN.apply_instrument_function" href="#HITRAN.apply_instrument_function"><code>HITRAN.apply_instrument_function</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">apply_instrument_function(ν, α[, instrument_function=:rectangular, instrument_wing=10.0, instrument_resolution=0.1])</code></pre><p>Applies an instrument function to the given input spectrum.</p><p><strong>Arguments</strong></p><ul><li><code>ν</code>: The wavenumber vector (NOTE: Uniform spacing is assumed but not checked!)</li><li><code>α</code>: The calculated absorption coefficient using <a href="#HITRAN.α"><code>α</code></a></li><li><code>instrument_function</code> (optional): A Symbol describing one of the instrument functions below</li><li><code>instrument_wing</code> (optional): The half-width of the range for calculating the instrument function in <span>$cm^{-1}$</span></li><li><code>instrument_resolution</code> (optional): The full-width of the instrument resolution in <span>$cm^{-1}$</span></li></ul><p><strong>Output</strong></p><p>Returns a new vector with the spectrum influenced by the instrument function</p><p><strong>Instrument functions</strong></p><p>The following instrument functions <span>$I(x, Δ)$</span> are supported. Here <code>x</code>is the coordinate for evaluating the function, whose range is given by <code>instrument_wing</code>. <code>Δ</code> is the resolution parameter <code>instrument_resolution</code>. Use the stated symbol as value for the argument <code>instrument_function</code>.</p><table><tr><th style="text-align: left">Symbol</th><th style="text-align: center">Equation</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: left"><code>:rectangular</code></td><td style="text-align: center"><span>$\begin{cases} \frac{1}{Δ} &amp; \lvert x \rvert \leq \frac{Δ}{2} \\ 0 &amp; \lvert x \rvert &gt; \frac{Δ}{2} \end{cases}$</span></td><td style="text-align: right">A rectangular instrument function</td></tr><tr><td style="text-align: left"><code>:triangular</code></td><td style="text-align: center"><span>$\begin{cases} \frac{1}{Δ} (1 - \frac{\lvert x \rvert}{Δ}) &amp; \lvert x \rvert \leq Δ \\ 0 &amp; \lvert x \rvert &gt; Δ \end{cases}$</span></td><td style="text-align: right">A triangular instrument function</td></tr><tr><td style="text-align: left"><code>:gaussian</code></td><td style="text-align: center"><span>$\frac{2}{Δ} \sqrt{\frac{\mathrm{ln}2}{\pi}} \mathrm{exp} \left (- \mathrm{ln}2 \left ( \frac{2x}{Δ}\right)^2 \right )$</span></td><td style="text-align: right">A Gaussian instrument function (e.g. a broadband source)</td></tr><tr><td style="text-align: left"><code>:lorentzian</code></td><td style="text-align: center"><span>$\frac{Δ}{2\pi} \frac{1}{x^2+\left(\frac{Δ}{2}\right)^2}$</span></td><td style="text-align: right">A Lorentzian instrument function (e.g. a single frequency laser)</td></tr><tr><td style="text-align: left"><code>:cosine</code></td><td style="text-align: center"><span>$\begin{cases} \frac{\pi}{4Δ} \cos \left ( \frac {\pi \lvert x \rvert}{2Δ} \right ) &amp; \lvert x \rvert \leq Δ \\ 0 &amp; \lvert x \rvert &gt; Δ \end{cases}$</span></td><td style="text-align: right">A cosine instrument function</td></tr><tr><td style="text-align: left"><code>:diffraction</code></td><td style="text-align: center"><span>$\frac{1}{Δ} \mathrm{sinc}^2 \left(  \frac{\pi x}{Δ} \right)$</span></td><td style="text-align: right">A diffraction (sinc-type) instrument function</td></tr><tr><td style="text-align: left"><code>:michelson</code></td><td style="text-align: center"><span>$\frac{2}{Δ} \mathrm{sinc} \left(  \frac{2 \pi x}{Δ} \right)$</span></td><td style="text-align: right">A Michelson interferometer-type instrument function (e.g. FTIR)</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/instruments.jl#LL36-L67">source</a></section></article><h3 id="Overview-of-instrument-functions"><a class="docs-heading-anchor" href="#Overview-of-instrument-functions">Overview of instrument functions</a><a id="Overview-of-instrument-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-instrument-functions" title="Permalink"></a></h3><p>The following graph shows all supported instrument functions for a resolution of <span>$0.1 cm^{-1}$</span>.</p>/home/runner/work/HITRAN.jl/HITRAN.jl/docs/build/plot.svg<p><img src="../plot.svg" alt/></p><h2 id="Convenience-functions"><a class="docs-heading-anchor" href="#Convenience-functions">Convenience functions</a><a id="Convenience-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Convenience-functions" title="Permalink"></a></h2><p>The following three functions are provided as a convenience to convert the absorption coefficient to either an absorption spectrum, transmittance spectrum or an optical depth.</p><article class="docstring"><header><a class="docstring-binding" id="HITRAN.absorption_spectrum" href="#HITRAN.absorption_spectrum"><code>HITRAN.absorption_spectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">absorption_spectrum(α, len)</code></pre><p>Computes the absorption spectrum for the given length <code>len</code> in centimeters. The vector <code>α</code> should be calculated using the corresponding <a href="#HITRAN.α"><code>α</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/spectra.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HITRAN.transmittance_spectrum" href="#HITRAN.transmittance_spectrum"><code>HITRAN.transmittance_spectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transmittance_spectrum(α, len)</code></pre><p>Computes the transmittance spectrum for the given length <code>len</code> in centimeters. The vector <code>α</code> should be calculated using the corresponding <a href="#HITRAN.α"><code>α</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/spectra.jl#LL9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HITRAN.optical_depth" href="#HITRAN.optical_depth"><code>HITRAN.optical_depth</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">optical_depth(α, len)</code></pre><p>Computes the optical depth for the given length <code>len</code> in centimeters. The vector <code>α</code> should be calculated using the corresponding <a href="#HITRAN.α"><code>α</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/spectra.jl#LL17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HITRAN.frequency_to_wavenumber" href="#HITRAN.frequency_to_wavenumber"><code>HITRAN.frequency_to_wavenumber</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">frequency_to_wavenumber(x)</code></pre><p>Converts a given frequency in Hz to wavenumber in <span>$cm^{-1}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/util.jl#LL3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HITRAN.wavelength_to_wavenumber" href="#HITRAN.wavelength_to_wavenumber"><code>HITRAN.wavelength_to_wavenumber</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">wavelength_to_wavenumber(x)</code></pre><p>Converts a given wavelength in m to wavenumber in <span>$cm^{-1}$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tachawkes/hitran.jl/blob/505a622183657e8e14f7dd04bcda02d5b5f31f3b/src/util.jl#LL10-L14">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Picard2008"><a class="tag is-link" href="#citeref-Picard2008">Picard2008</a>A., Picard, R.S., Davis, M., Gläser and K., Fujii (2008), Revised formula for the density of moist air (CIPM-2007), Metrologia 45, 149–155 (2008).</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../database/">« Local HITRAN database</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 5 January 2023 08:49">Thursday 5 January 2023</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
