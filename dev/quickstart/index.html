<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quickstart/Example · HITRAN.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">HITRAN.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction &amp; Motivation</a></li><li class="is-active"><a class="tocitem" href>Quickstart/Example</a><ul class="internal"><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#Populating-the-local-database"><span>Populating the local database</span></a></li><li><a class="tocitem" href="#Calculating-a-spectrum"><span>Calculating a spectrum</span></a></li><li><a class="tocitem" href="#Full-code-and-plotting"><span>Full code &amp; plotting</span></a></li></ul></li><li><a class="tocitem" href="../database/">Local HITRAN database</a></li><li><a class="tocitem" href="../spectra/">Calculating spectra</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quickstart/Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quickstart/Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tachawkes/hitran.jl/blob/master/docs/src/quickstart.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmospheric-transmission-at-the-oxygen-A-band"><a class="docs-heading-anchor" href="#Atmospheric-transmission-at-the-oxygen-A-band">Atmospheric transmission at the oxygen A-band</a><a id="Atmospheric-transmission-at-the-oxygen-A-band-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-transmission-at-the-oxygen-A-band" title="Permalink"></a></h1><p>The oxygen A-band is a spectral band of molecular oxygen <span>$O_2$</span> in the wavelength region of about 759 nanometers to 771 nanometers. Molecular oxygen is quite remarkable because its ground state is a triplet configuration for the electrons and as everything would oxidize quite rapidly in our atmosphere if this would not be the case, we should be happy for this fact. The A-band is basically formed by the electronic transition from the ground state to the second excited singlet state in its lowest vibrational state. The band consists of a lot of individual transitions involving different rotational quantum states. For further reading pick your favorite spectroscopy textbook and have a look at the details (it is a rabbit hole with no end... and that&#39;s the fun part ;)).</p><p>Let&#39;s say we want to know the A-band spectrum at standard HITRAN conditions (<span>$T=296\,\text{K}, p=1.0\,\text{atm}$</span>) and what is the maximum transmission through a 100 m air column. For simplicity we assume that the conditions (and abundance does not change along this air column.</p><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><p>We start by loading the module:</p><pre><code class="language-julia-repl">julia&gt; using HITRAN</code></pre><p>Now we could specify a database using the function <code>open_database</code> or just stick to the default database. If no database is specified, the package will just use a default database in a file named <code>HITRAN.sqlite</code> in your current environment folder.</p><h2 id="Populating-the-local-database"><a class="docs-heading-anchor" href="#Populating-the-local-database">Populating the local database</a><a id="Populating-the-local-database-1"></a><a class="docs-heading-anchor-permalink" href="#Populating-the-local-database" title="Permalink"></a></h2><p>We need line-by-line data, so let&#39;s fetch it using:</p><pre><code class="language-julia-repl">julia&gt; fetch!(&quot;StdAtm&quot;, iso_id([&quot;N2&quot;, &quot;O2&quot;, &quot;CO2&quot;, &quot;H2O&quot;, &quot;CH4&quot;]), 12900, 13200, [:standard, :ht_self]);
[ Info: No custom HITRAN database specified, opening &#39;HITRAN.sqlite&#39; (default)</code></pre><p>Not this command needs some explanation. First of all it is named <code>fetch!</code>with exclamation mark because it modifies the underlying database and is therefore considered &quot;mutating&quot;. The parameters are the following:</p><table><tr><th style="text-align: left">parameter</th><th style="text-align: center">description</th><th style="text-align: right">example value</th></tr><tr><td style="text-align: left"><code>name</code></td><td style="text-align: center">A user-chosen identifier used as table name in the database</td><td style="text-align: right"><code>&quot;StdAtm&quot;</code></td></tr><tr><td style="text-align: left"><code>global_iso_ids</code></td><td style="text-align: center">A list of <a href="https://hitran.org/docs/iso-meta/">global isotopologue IDs</a>. The <code>iso_id</code> function is a convenience function which allows to lookup iso ids by formula (either molecule or isotopologue) or by molecule/local id</td><td style="text-align: right"><code>iso_id([&quot;N2&quot;, &quot;O2&quot;, &quot;CO2&quot;, &quot;H2O&quot;, &quot;CH4&quot;])</code></td></tr><tr><td style="text-align: left"><code>ν_min</code></td><td style="text-align: center">The minimum wavenumber (in <span>$cm^{-1}$</span>) to consider</td><td style="text-align: right"><code>12900</code></td></tr><tr><td style="text-align: left"><code>ν_max</code></td><td style="text-align: center">The maximum wavenumber (in <span>$cm^{-1}$</span>) to consider</td><td style="text-align: right"><code>13200</code></td></tr><tr><td style="text-align: left"><code>parameters</code></td><td style="text-align: center">A list of HITRAN line parameters to get. As nobody wants to remember these, there are shortcuts defined as symbols. The default HITRAN parameter set can be specified with :standard. In this case we additionally want to fetch the Hartmann-Tran paramters (if available).</td><td style="text-align: right"><code>[:standard, :ht_self]</code></td></tr></table><div class="admonition is-info"><header class="admonition-header">Why are we fetching N2, CO2, H2O and CH4 instead of just O2?</header><div class="admonition-body"><p>For this example it would be sufficient to just fetch O2 spectral lines as there are only some weak H2O lines in the A-band. But it showcases how a table containing multiple components can be setup.</p></div></div><p>Now that we have a table called &quot;StdAtm&quot; (for Standard Atmosphere) with some of the more relevant atmospheric constituents, we can already calculate a spectrum. One more important detail: The fetch commands generates a hash of the url used to query the HITRAN database. If you make a consecutive <code>fetch!</code> call with exactly the same parameters, no new download will be initiated. This is also handy because you do not need to comment/uncomment <code>fetch!</code> commands in your code to disable download. As soon as you change the parameters (for example the wavenumber limit) new data will be downloaded.</p><h2 id="Calculating-a-spectrum"><a class="docs-heading-anchor" href="#Calculating-a-spectrum">Calculating a spectrum</a><a id="Calculating-a-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-a-spectrum" title="Permalink"></a></h2><p>The most simple approach would be to just straight away call this command:</p><pre><code class="language-julia-repl">julia&gt; wavenumbers, absorption_coefficient = α(
           [&quot;StdAtm&quot;]
       )
(12900.42124:0.01:13199.94124, [1.5535278120988532e-7, 1.4930878860980838e-7, 1.3338349450734903e-7, 1.1264056346447544e-7, 9.18811618680111e-8, 7.385348768093414e-8, 5.935414798470365e-8, 4.810609728362824e-8, 3.9480572686550304e-8, 3.285259984526768e-8  …  1.1972810418009874e-8, 1.1831256251790585e-8, 1.169161117169272e-8, 1.1553690521769383e-8, 1.1417315397704842e-8, 1.1282316662030717e-8, 1.1148538765402434e-8, 1.1015843228360957e-8, 1.0884111639639771e-8, 1.0753248041163345e-8])</code></pre><p>As you can see, we get a range of wavenumber values and values for the absorption coefficient right away. But wait, how does the module know the atmospheric composition we are interested in? In short: It does not! If you just specify a table name to the <code>α</code> function it will just calculate all spectral lines withing the table assuming their natural isotopologue abundance and does not take the proper gas mixture into account. See the function description of <a href="../spectra/#HITRAN.α"><code>α</code></a> for all details. For this example, we can use a neat shortcut:</p><pre><code class="language-julia-repl">julia&gt; wavenumbers, absorption_coefficient = α(
           [&quot;StdAtm&quot;];
           components=default_environments[:dry_air]
       )
(12900.42124:0.01:13199.94124, [3.238373918706099e-8, 3.112104292683743e-8, 2.7792868593764442e-8, 2.3449314504389195e-8, 1.9092173795586206e-8, 1.5300563553226105e-8, 1.224640498934714e-8, 9.874747787425443e-9, 8.054873718938892e-9, 6.655765518150035e-9  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])</code></pre><p>The <code>default_environment</code> variable is a <code>Dict</code> containing standard mixtures. For now this is only dry air by using the key <code>:dry_air</code>. Great, what is left? Actually to match the behaviour of the HAPI, we also have to specify how our species is diluted by the environment.</p><div class="admonition is-warning"><header class="admonition-header">Calculate diluted mixtures separately and sum them afterwards</header><div class="admonition-body"><p>The following diluent specification is actually wrong for the H2O lines overlapping the A-band spectral region. Because they are to weak, we get away with this here. If you are in a spectral band where you have to properly adjust for the self-/air-broadening, you should calculate the spectra for each component one by one and add them later. Specifying a <code>:self</code> dilution applies to <strong>all</strong> specified components.</p></div></div><h3 id="The-final-code"><a class="docs-heading-anchor" href="#The-final-code">The final code</a><a id="The-final-code-1"></a><a class="docs-heading-anchor-permalink" href="#The-final-code" title="Permalink"></a></h3><p>To sum it all up, the correct code (besides the warning above) for this example is:</p><pre><code class="language-julia-repl">julia&gt; wavenumbers, absorption_coefficient = α([&quot;StdAtm&quot;];
               components=(default_environments[:dry_air]),
               diluent=Dict(:self =&gt; 0.209390, :air =&gt; 1 - 0.209390)
           )
(12900.42124:0.01:13199.94124, [3.169184303823752e-8, 2.909355642772485e-8, 2.5065937181625808e-8, 2.0673709833369115e-8, 1.666358913784054e-8, 1.3346007959211575e-8, 1.0736165039491937e-8, 8.724345444504152e-9, 7.1779051785027896e-9, 5.981576991733112e-9  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])</code></pre><p>This specifies that our oxygen is dilutet by the surrounding air mass which tells the module how to properly calculate the collision-broadening of the spectral lines.</p><p>To get the transmission along our air column we can use the little helper function and specifying the air path length in centimeters:</p><pre><code class="language-julia-repl">julia&gt; transmission = transmittance_spectrum(absorption_coefficient, 100e2);</code></pre><h2 id="Full-code-and-plotting"><a class="docs-heading-anchor" href="#Full-code-and-plotting">Full code &amp; plotting</a><a id="Full-code-and-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Full-code-and-plotting" title="Permalink"></a></h2><p>Let&#39;s put everything so far together and create a plot:</p><pre><code class="language-julia">using HITRAN, Plots

fetch!(&quot;StdAtm&quot;, iso_id([&quot;N2&quot;, &quot;O2&quot;, &quot;CO2&quot;, &quot;H2O&quot;, &quot;CH4&quot;]), 12900, 13200, [:standard, :ht_self]);
wavenumbers, absorption_coefficient = α([&quot;StdAtm&quot;];
        components=(default_environments[:dry_air]),
        diluent=Dict(:self =&gt; 0.209390, :air =&gt; 1 - 0.209390)
    )
transmission = transmittance_spectrum(absorption_coefficient, 100e2)

plot(
    wavenumbers,
    transmission,
    xlabel=&quot;Wavenumbers [1/cm]&quot;,
    ylabel=&quot;Transmission&quot;,
    title=&quot;Transmission along a 100 m air column&quot;,
    leg=false
)</code></pre><pre class="documenter-example-output">/home/runner/.julia/packages/GR/G9I5v/src/../deps/gr/bin/gksqt: error while loading shared libraries: libQt5Widgets.so.5: cannot open shared object file: No such file or directory
connect: Connection refused
GKS: can&#39;t connect to GKS socket application

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</pre><p><img src="../air-plot.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction &amp; Motivation</a><a class="docs-footer-nextpage" href="../database/">Local HITRAN database »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 21 February 2021 19:11">Sunday 21 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
